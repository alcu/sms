
use cellfun to avoid loops?
